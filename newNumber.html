<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html {
      background-color: rgb(170, 210, 210);
    }

    /* body {
      width: 300px;
      margin: auto;
    } */

    #title {
      text-align: center;
      margin-bottom: 0.5em;
    }

    #input {
      display: block;
      width: 3em;
      margin: 0 auto 0.1em;
      text-align: center;
      border-radius: 11px;
      border: black solid 1px;
      outline: none;
    }

    #input:focus {
      border: blue solid 1px;
    }

    #button {
      display: block;
      margin: auto;
      width: 10em;
      background-color: rgb(235, 235, 235);
      border: outset 3px;
      outline: none;
    }

    #button:active {
      border: inset 3px;
    }

    #button>span {
      display: inline-block;
    }

    #l {
      float: left;
    }

    #r {
      float: right;
    }
    .display{
      margin: 0.5em auto;
      height: 1.2em;
      text-align: center;
    }
    .display > span {
      display: inline-block;
      vertical-align: top;
    }
    .maru{
      display: inline-block;
      border-radius: 50%;
      background-color: red;
      margin-left: 1.3em;
    }
    .sankaku{
      display: inline-block;
      width:0;
      height: 0;
      border-style: solid;
      border-color: transparent transparent blue;
      margin-left: 0.7em;
    }
  </style>
  <title>数字あてゲーム</title>
</head>

<body>
  <style id="style"></style>
  <div id="title">数字あてゲーム</div>
  <div><input type="tel" id="input" maxlength="3"></div>
  <button id="button"><span><span id="l">↓</span>解答<span id="r">↓</span></span></button>
  <div id="area"></div>


  <script>
    const sm = navigator.userAgent.match(/(iPhone|iPad|iPod|Android)/i);//  ${sm?:}
    document.getElementById('style').innerHTML = `
      #title {
        font-size: ${sm ? 16 : 28}px;
      }
      #input {
        font-size: ${sm ? 20 : 32}px;
      }
      #button {
        font-size: ${sm ? 12 : 20}px;
      }
      #button > span {
        width: ${sm ? 90 : 140}px;
      }
      .display{
        font-size: ${sm ? 16 : 32}px;
      }
      .display > span {
        line-height: ${sm ? 20 : 40}px;
      }
      .maru {
        width: ${sm ? 16 : 32}px;
        height: ${sm ? 16 : 32}px;
      }
      .sankaku {
        border-width: 0 ${sm ? 10 : 19}px ${sm ? 16 : 32}px;
      }
    `;

    const input = document.getElementById('input');
    const button = document.getElementById('button');
    const area = document.getElementById('area');

    let number = [1, 2, 3, 4, 5, 6, 7, 8, 9];
    let anser = '';
    for (let i = 0; i < 3; i++) {
      let random = number[Math.floor(Math.random() * (9 - i))]
      anser += random;
      number.splice(number.indexOf(random), 1);
    }
    console.log(anser);

    button.onclick = () => {
      click();
    }

    input.onkeydown = (e) => {
      if (e.keyCode == 13) click();
    }

    const click = () => {
      let n = input.value;
      if (isNaN(n) || n.length != 3 || n[0] == n[1] || n[0] == n[2] || n[1] == n[2] || -1 < n.indexOf(0)) {
        alert('できません');
      } else {
        let o = 0;
        let x = 0;
        for (let i = 0; i < 3; i++) {
          let n1 = n[i];
          for (let j = 0; j < 3; j++) {
            let a1 = anser[j];
            if (n1 == a1) {
              if (i == j) {
                o++;
              } else {
                x++;
              }
            }
          }
        }
        console.log(o, x)
        area.innerHTML+=`<div class="display"><span>${n}</span><div class="maru"></div><span>${o}</span><div class="sankaku"></div><span>${x}</span></div>`;

      }
    }

    input.value = 517;click();


  </script>
</body>

</html>
